- 所有内容都写在这一个文档里，省的翻来翻去，怕麻烦，善用ctrl+F搜索文章内容

- 使用说明的框架包括两个部分：
    - 软件使用说明
    - 数据库挖掘分析方法实现

- #### 常见套路归纳：
    
    1. 单个药物的不良事件分析；
    2. 单个药物对于某一类不良事件的分析；
    3. 多个药物的不良事件分析；
    4. 多个药物针对某一个/某一类不良事件的分析；
    5. 某种不良反应是哪些药物引起的
    6. 联合用药。
    
### 总体概述和目录
    - 这篇笔记会列举一些分析的角度，以及如何利用配套软件工具实现数据分析和图形化
    - 做科研的一般性思路，就是去先找到一篇对标的文章，然后原封不动的抄袭它的方法，用抄来的方法去研究自己的实验对象，如有必要，再做调整。——————某大佬
    
    
1. 基础
    - 这个课题的核心目的是探究药物和不良反应二者之间的关系，适用这个分析场景的统计学方法有：ROR、PRR、BCPNN、MGPS等等。原理都在衡量某药物的某不良反应发生情况在整个数据库背景下的不对称性。这几种算法的Features的概念均来自于比例失衡四格表。
    - 算法公式、阈值和在线计算器请见附加文件。算法越复杂，其可解释性越低，尤其以BCPNN、经验贝叶斯为代表的贝叶斯方法为盛，鼓励去深入研究。PS：从港大经济学系揪出来100个人，可能没有1个人能把BCPNN的推导过程说清晰。
    - 本软件涉及到的机器学习方法，之所以表现有时优于传统算法，并非因为常见的这些机器学习方法比传统方法更加高明，而是因为我们抽提出了更多features，并将之作为影响因素去考虑。

2. 多药分析和单药分析
    - 多药分析是基于单药的，先选择分析角度，再观察每种药物在这些分析角度上的差异，并且在文章中给出解释or描述。
    - 多药分析的目的在于对比同一类药物之间在引起不良事件时的异同。同样毒理的同类药物引起不良事件的程度可能不一样；而不同毒理、靶点、分子机制的同一类药物引起的不良事件情况可能天差地别。
    - 其他的任何分析角度，都可以结合单药或者多药的分析进行

3. 联用药物分析
    - 如果在第四条药物联用情况分析中发现：药物A常常于B联用，然后我想探究A单独使用和联合B使用时两种情景发生的不良事件情况
    - 信号监测系统框中输入：A#B，为单独用A的情况挖掘；框中输入：A&B，为药物A在联用B的情况下挖掘
    - 如果不需要检测信号值，直接用亚组分析工具（小数据）处理导出的原始数据即可
    - 所有程序的药物名称数据框，均可以用这个筛选逻辑：+，&，#表示或、与、非的线性运算逻辑。详见软件使用说明
    
4. 药物联用情况分析
    - 在运行信号监测系统之后，导出报告中，有原始数据，其中DRUG_GOAL中有具体的每个报告的详细用药情况
    - 运行小工具：药物-作用代码-对应的不良报告个数计数器.exe，选择DRUG_GOAL.csv，会导出一个计数表格，即可查看药物使用情况
    - 去除计数表格的目标药物的条目，剩下的即是药物联用情况，用[S2015]绘图
    
5. 诱发时间曲线和韦伯分布
    - 数据库中有记录，某种药物从开始使用，到不良事件的发生之间的时间段，此数据被作为诱发时间分析。

    - [3001][C0009]Time-to-onset条形图绘制
    - [2010]累积发生率
    - [2005]诱发时间韦伯分布：使用 bootstrap 方法计算置信区间，可调整n_iterations的取值来改变重采样次数，default = 100
    - **Weibull分布参数**：
       - **Scale (α)**：尺度参数，表示特征寿命（63.2%的样本发生失效的时间），其95%置信区间（CI）反映参数估计的稳定性。
       - **Shape (β)**：形状参数，决定失效风险随时间的变化模式：
         - β < 1：风险递减（早期失效）。
         - β = 1：风险恒定（随机失效）。
         - β > 1：风险递增（损耗失效）。
    - **Failure Type**：失效类型，基于形状参数（β）的统计学判断。
        1. **Early Failure（早期失效）**：  
           - **条件**：形状参数（β）的95%置信区间不包含1，且β < 1。  
           - **含义**：失效风险随时间递减，早期事件发生率高（如药物不良反应早期出现）。  
           - **示例**：肝功异常（β=0.80，CI=0.65–0.94）和肝衰竭（β=0.69，CI=0.48–0.90）。

        2. **Random Failure（随机失效）**：  
           - **条件**：形状参数（β）的95%置信区间包含1。  
           - **含义**：失效风险恒定，事件随机发生（符合指数分布）。  
           - **示例**：疾病进展（β=0.83，CI=0.65–1.00）和腹水（β=0.87，CI=0.73–1.01）。    
    - [P1009]多药累计发生率对比图像绘制
    - [P1010]多亚组累计发生率对比图像绘制
    
6. 信号值（PT）分析（作图脚本太多了，只讲典型案例）
    - [1004]多算法韦恩分布
    - [1002]TOP不良事件条形图
    - [P1006]多药对比TOP不良事件热力图
    - [P1007]多亚组对比TOP不良事件热力图
    - [1010]、[1011]ROR火山图

7. 信号值（SOC）分析（作图脚本太多了，只讲典型案例）
    - 个人认为做SOC层级没任何必要，不过很多文章在搞，就跟风做了。
    - 功能是整体看一下，不良事件集中在哪些器官系统层级
    - [1008]条形图
    - [1000]森林图
    
8. 年龄亚组信号分析：
    - 目标药物可能在不同年龄人群中引起的不良反应有差异
    - 用亚组分析工具（大数据）操作，详见软件操作说明
    - 如果不需要检测信号值，直接用亚组分析工具（小数据）处理导出的原始数据即可

9. 性别亚组信号分析：
    - 目标药物可能在不同性别人群中引起的不良反应有差异
    - 用亚组分析工具（大数据）操作，详见软件操作说明
    - 如果不需要检测信号值，直接用亚组分析工具（小数据）处理导出的原始数据即可
    
10. 性别，年龄和年龄-性别的累计变化分析：
    - [2004]、[2008]、[C0002]、[C0005]等
    - [3002]年龄-性别频数分布-分组柱状图等
    - [C0006]数据统计表-年龄-性别频数分布-堆叠柱状图等
    
11. 不良报告上报者分析：
    - 数据库中的代号是二字代码，看不明白的，去看附件中的文件
    - [2007]、[C0004]作图
    
12. 不良反应上报时间分析：
    - [2011]、[2002]、[2001]等
    
13. 体重段位分析\国家分析：
    - [2008]、[2006]
    
14. **某种不良反应是哪些药物引起的：**
    - 亚组分析工具（大数据）：筛选某个或者某些PT
    - 小工具：去重，处理导出的数据
    - 小工具：药物-作用代码-对应的不良报告个数计数器，看目标不良反应是哪些药物引起的.[S2012]、[S2014]作泡泡和树状图
    - 信号监测系统：看这些药物和此不良反应之间的相关信号计算
    - 信息统计工具：制表+各种脚本作图
    - 亚组分析：可针对年龄段、性别等进一步分析，作图。先用csv格式转换工具、再用亚组分析工具（小数据），再如法炮制分析作图
    - 此不良反应的并发症分析：树状图、泡泡矩阵、层次聚类算法
    
    
    